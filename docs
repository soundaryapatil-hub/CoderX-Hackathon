<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Women Safety Navigator - Belagavi</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body {margin:0;font-family:'Roboto',sans-serif;color:#fff;background:linear-gradient(270deg,#ff6a00,#ee0979,#8e2de2);background-size:600% 600%;animation:gradientBG 15s ease infinite;overflow-x:hidden;}
@keyframes gradientBG{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
h1,h2{margin:0;}
.fade-in{opacity:0;transform:translateY(20px);transition:opacity 1s,transform 1s;}
.fade-in.visible{opacity:1;transform:translateY(0);}

.hero{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;}
.hero h1{font-size:2.8rem;margin-bottom:16px;text-shadow:2px 2px 8px rgba(0,0,0,0.35);}
.btns{display:flex;gap:12px;flex-wrap:wrap;}
.btn{background:#fff;color:#ff6a00;border:none;padding:14px 26px;border-radius:50px;cursor:pointer;transition:.25s;box-shadow:0 5px 15px rgba(0,0,0,0.2);}
.btn:hover{transform:scale(1.06);background:#ffe0b2;}
.btn.alt{background:rgba(255,255,255,0.12);color:#fff;border:1px solid rgba(255,255,255,0.22);backdrop-filter:blur(10px);}
.btn.alt:hover{background:rgba(255,255,255,0.18);}

.cards{display:flex;flex-wrap:wrap;justify-content:center;padding:40px 20px;gap:20px;background:rgba(0,0,0,0.2);}
.card{background:rgba(255,255,255,0.12);backdrop-filter:blur(10px);border-radius:14px;padding:20px;width:250px;text-align:center;transition:transform .3s,box-shadow .3s;cursor:pointer;border:1px solid rgba(255,255,255,0.18);}
.card:hover{transform:translateY(-8px);box-shadow:0 12px 28px rgba(0,0,0,0.4);}
.card h2{margin-bottom:10px;font-size:1.25rem;}
.card p{opacity:.95;margin:0;}

.app{padding:40px 20px;background:rgba(0,0,0,0.28);text-align:center;}
.controls{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:10px 0;}
select{padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,0.25);background:rgba(0,0,0,0.25);color:#fff;outline:none;font-size:14px;}
.box{height:400px;border:2px solid rgba(255,255,255,0.25);margin:12px auto;width:92%;max-width:900px;border-radius:16px;overflow:hidden;background:rgba(0,0,0,0.25);}
#map{height:100%;width:100%;}
.safe{color:#22c55e;font-weight:bold;}
.danger{color:#ef4444;font-weight:bold;}

.dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:6px;}
.dot.green{background:#22c55e;}
.dot.red{background:#ef4444;}

@media(max-width:768px){.hero h1{font-size:2rem;}.card{width:88%;max-width:350px;}.box{height:350px;}}
</style>
</head>

<body>

<section class="hero fade-in">
  <h1>Women Safety Navigator</h1>
  <div class="btns">
    <button class="btn" onclick="scrollToApp()">Check Route</button>
    <button class="btn alt" onclick="openMap('Tilakwadi')">Open Map</button>
    <button class="btn alt" onclick="getDirections('Rani Chennamma Circle')">Get Directions</button>
  </div>
</section>

<section class="cards fade-in">
  <div class="card" onclick="openMap('Rani Chennamma Circle')"><h2>Rani Chennamma Circle</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Tilakwadi')"><h2>Tilakwadi</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('KLE Hospital Belagavi')"><h2>KLE Hospital</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Shahapur')"><h2>Shahapur</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Angol')"><h2>Angol</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Belagavi Railway Station')"><h2>Belagavi Railway Station</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Municipal Corporation')"><h2>Municipal Corporation</h2><p>Open Google Maps</p></div>
  <div class="card" onclick="openMap('Bhutar Circle')"><h2>Bhutar Circle</h2><p>Open Google Maps</p></div>
</section>

<section class="app fade-in" id="app">
  <h2>Safety Route Analysis</h2>
  <div class="controls">
    <select id="source"></select>
    <select id="destination"></select>
    <select id="time"><option value="0">Day</option><option value="1">Night</option></select>
    <button class="btn" id="btn">Check Safety</button>
  </div>
  <div class="legend">
    <span><span class="dot green"></span>Safer Route</span>
    <span><span class="dot red"></span>High Risk Route</span>
  </div>
  <div class="box"><div id="map"></div></div>
  <h3 id="result"></h3>
</section>

<script>
// Fade-in animation
const elements=document.querySelectorAll('.fade-in');
function reveal(){elements.forEach(el=>{if(el.getBoundingClientRect().top<window.innerHeight-120)el.classList.add('visible');});}
window.addEventListener('scroll',reveal);window.addEventListener('load',reveal);

// Scroll to map section
function scrollToApp(){document.getElementById("app").scrollIntoView({behavior:"smooth"});setTimeout(()=>{if(window._mapInstance)window._mapInstance.invalidateSize();},500);}

// Open map in new tab
function openMap(place){window.open(`https://www.google.com/maps/place/${encodeURIComponent(place)}`,'_blank','noopener,noreferrer');}

// Get directions restricted to Belagavi
const belagaviCenter = "15.8497,74.4977";
function getDirections(destination){
  const origin = document.getElementById("source").value || belagaviCenter;
  const url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}&travelmode=driving`;
  window.open(url,'_blank','noopener,noreferrer');
}

// Locations (8 total)
const areas={
  "Rani Chennamma Circle":{crime:14,crowd:27,lat:15.8497,lng:74.4977},
  "Tilakwadi":{crime:16,crowd:25,lat:15.8526,lng:74.5057},
  "Shahapur":{crime:29,crowd:25,lat:15.8466,lng:74.5169},
  "Angol":{crime:15,crowd:17,lat:15.8589,lng:74.5085},
  "KLE Hospital":{crime:3,crowd:58,lat:15.8572,lng:74.5257},
  "Belagavi Railway Station":{crime:10,crowd:40,lat:15.8491,lng:74.5018},
  "Municipal Corporation":{crime:8,crowd:20,lat:15.8499,lng:74.5025},
  "Bhutar Circle":{crime:12,crowd:30,lat:15.8560,lng:74.5110}
};

// Risk settings
const CRIME_WEIGHT=0.6,CROWD_WEIGHT=0.3,NIGHT_PENALTY=4,HIGH_RISK_THRESHOLD=7;
function calcRisk(c1,co1,c2,co2,time){const avgC=(c1+c2)/2;const avgCo=(co1+co2)/2;return Math.round(((avgC*CRIME_WEIGHT)+(time*NIGHT_PENALTY)-(avgCo*CROWD_WEIGHT))*100)/100;}

// Populate dropdowns
const sourceSel=document.getElementById("source"),destSel=document.getElementById("destination");
Object.keys(areas).forEach(name=>{
  const o1=document.createElement("option");o1.value=name;o1.textContent=name;sourceSel.appendChild(o1);
  const o2=document.createElement("option");o2.value=name;o2.textContent=name;destSel.appendChild(o2);
});
sourceSel.value="Tilakwadi";destSel.value="Rani Chennamma Circle";

// Leaflet map
const map=L.map("map").setView([15.8526,74.5057],13);window._mapInstance=map;
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap"}).addTo(map);

let sMarker=null,dMarker=null,routeLine=null;
function clearRoute(){if(sMarker)map.removeLayer(sMarker);if(dMarker)map.removeLayer(dMarker);if(routeLine)map.removeLayer(routeLine);sMarker=dMarker=routeLine=null;}
function drawLine(s,d,color){routeLine=L.polyline([[s.lat,s.lng],[d.lat,d.lng]],{color,weight:7,opacity:0.9}).addTo(map);map.fitBounds(routeLine.getBounds(),{padding:[30,30]});}
function drawRoute(src,dst){
  const s=areas[src],d=areas[dst];clearRoute();
  sMarker=L.marker([s.lat,s.lng]).addTo(map).bindPopup("Source: "+src);
  dMarker=L.marker([d.lat,d.lng]).addTo(map).bindPopup("Destination: "+dst);
  if(src===dst){routeLine=L.circle([s.lat,s.lng],{radius:250,color:"green",weight:7}).addTo(map);map.setView([s.lat,s.lng],14);return;}
  const url=`https://router.project-osrm.org/route/v1/driving/${s.lng},${s.lat};${d.lng},${d.lat}?overview=full&geometries=geojson`;
  const xhr=new XMLHttpRequest();xhr.open("GET",url,true);xhr.timeout=8000;
  xhr.onreadystatechange=function(){if(xhr.readyState!==4)return;try{if(xhr.status===200){const data=JSON.parse(xhr.responseText);if(data.routes&&data.routes.length>0){const coords=data.routes[0].geometry.coordinates;const latLngs=coords.map(c=>[c[1],c[0]]);routeLine=L.polyline(latLngs,{color,weight:7,opacity:0.9}).addTo(map);map.fitBounds(routeLine.getBounds(),{padding:[30,30]});return;}}}catch(e){}drawLine(s,d,"green");};
  xhr.ontimeout=function(){drawLine(s,d,"green");};xhr.send();
}

function checkRoute(){
  const src=sourceSel.value,dst=destSel.value,time=parseInt(document.getElementById("time").value,10);
  const s=areas[src],d=areas[dst];
  const score=calcRisk(s.crime,s.crowd,d.crime,d.crowd,time);
  const high=score>HIGH_RISK_THRESHOLD;
  drawRoute(src,dst,high?"red":"green");
  const r=document.getElementById("result");
  r.textContent=high?`⚠ High Risk Route | Score: ${score}`:`✅ Safer Route | Score: ${score}`;
  r.className=high?"danger":"safe";
}

document.getElementById("btn").addEventListener("click",()=>{checkRoute();setTimeout(()=>map.invalidateSize(),50);});
window.addEventListener("load",()=>{checkRoute();setTimeout(()=>map.invalidateSize(),200);});
</script>
</body>
</html>
